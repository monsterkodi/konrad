// koffee 1.12.0

/*
 0000000   0000000   000   000  00000000  000   0000000 
000       000   000  0000  000  000       000  000      
000       000   000  000 0 000  000000    000  000  0000
000       000   000  000  0000  000       000  000   000
 0000000   0000000   000   000  000       000   0000000
 */
var _, noon, obj, path, ref, slash;

ref = require('kxk'), slash = ref.slash, noon = ref.noon, _ = ref._;

path = function(key, p, opt) {
    var o, ref1;
    while (slash.dir(p).length && ((ref1 = slash.dir(p)) !== '.' && ref1 !== '/')) {
        p = slash.dir(p);
        if (slash.fileExists(slash.join(p, '.konrad.noon'))) {
            o = _.defaultsDeep(noon.load(slash.join(p, '.konrad.noon')), opt);
            if (o[key] != null) {
                return slash.resolve(p);
            }
        }
    }
    return null;
};

obj = function(p, opt) {
    var o, ref1, ref2;
    if (opt == null) {
        opt = {};
    }
    while (slash.dir(p).length && ((ref2 = slash.dir(p)) !== '.' && ref2 !== '/') && !/^\w\:\/$/.test(slash.dir(p))) {
        p = slash.dir(p);
        if (slash.fileExists(slash.join(p, '.konrad.noon'))) {
            o = _.defaultsDeep(noon.load(slash.join(p, '.konrad.noon')), opt);
            if (((ref1 = o.ignore) != null ? ref1.map : void 0) != null) {
                o.ignore = o.ignore.map(function(i) {
                    if (_.isString(i)) {
                        return new RegExp(i);
                    } else {

                    }
                });
            }
            return o;
        }
    }
    return opt;
};

module.exports = {
    path: path,
    obj: obj
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZmlnLmpzIiwic291cmNlUm9vdCI6Ii4uL2NvZmZlZSIsInNvdXJjZXMiOlsiY29uZmlnLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxNQUFxQixPQUFBLENBQVEsS0FBUixDQUFyQixFQUFFLGlCQUFGLEVBQVMsZUFBVCxFQUFlOztBQUVmLElBQUEsR0FBTyxTQUFDLEdBQUQsRUFBTSxDQUFOLEVBQVMsR0FBVDtBQUVILFFBQUE7QUFBQSxXQUFNLEtBQUssQ0FBQyxHQUFOLENBQVUsQ0FBVixDQUFZLENBQUMsTUFBYixJQUF3QixTQUFBLEtBQUssQ0FBQyxHQUFOLENBQVUsQ0FBVixFQUFBLEtBQXFCLEdBQXJCLElBQUEsSUFBQSxLQUF5QixHQUF6QixDQUE5QjtRQUNJLENBQUEsR0FBSSxLQUFLLENBQUMsR0FBTixDQUFVLENBQVY7UUFDSixJQUFHLEtBQUssQ0FBQyxVQUFOLENBQWlCLEtBQUssQ0FBQyxJQUFOLENBQVcsQ0FBWCxFQUFjLGNBQWQsQ0FBakIsQ0FBSDtZQUNJLENBQUEsR0FBSSxDQUFDLENBQUMsWUFBRixDQUFlLElBQUksQ0FBQyxJQUFMLENBQVUsS0FBSyxDQUFDLElBQU4sQ0FBVyxDQUFYLEVBQWMsY0FBZCxDQUFWLENBQWYsRUFBd0QsR0FBeEQ7WUFDSixJQUFHLGNBQUg7QUFDSSx1QkFBTyxLQUFLLENBQUMsT0FBTixDQUFjLENBQWQsRUFEWDthQUZKOztJQUZKO1dBTUE7QUFSRzs7QUFVUCxHQUFBLEdBQU0sU0FBQyxDQUFELEVBQUksR0FBSjtBQUVGLFFBQUE7O1FBRk0sTUFBSTs7QUFFVixXQUFNLEtBQUssQ0FBQyxHQUFOLENBQVUsQ0FBVixDQUFZLENBQUMsTUFBYixJQUF3QixTQUFBLEtBQUssQ0FBQyxHQUFOLENBQVUsQ0FBVixFQUFBLEtBQXFCLEdBQXJCLElBQUEsSUFBQSxLQUF5QixHQUF6QixDQUF4QixJQUEwRCxDQUFJLFVBQVUsQ0FBQyxJQUFYLENBQWdCLEtBQUssQ0FBQyxHQUFOLENBQVUsQ0FBVixDQUFoQixDQUFwRTtRQUNJLENBQUEsR0FBSSxLQUFLLENBQUMsR0FBTixDQUFVLENBQVY7UUFDSixJQUFHLEtBQUssQ0FBQyxVQUFOLENBQWlCLEtBQUssQ0FBQyxJQUFOLENBQVcsQ0FBWCxFQUFjLGNBQWQsQ0FBakIsQ0FBSDtZQUNJLENBQUEsR0FBSSxDQUFDLENBQUMsWUFBRixDQUFlLElBQUksQ0FBQyxJQUFMLENBQVUsS0FBSyxDQUFDLElBQU4sQ0FBVyxDQUFYLEVBQWMsY0FBZCxDQUFWLENBQWYsRUFBd0QsR0FBeEQ7WUFDSixJQUFHLHVEQUFIO2dCQUNJLENBQUMsQ0FBQyxNQUFGLEdBQVcsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxHQUFULENBQWEsU0FBQyxDQUFEO29CQUNwQixJQUFHLENBQUMsQ0FBQyxRQUFGLENBQVcsQ0FBWCxDQUFIOytCQUNJLElBQUksTUFBSixDQUFXLENBQVgsRUFESjtxQkFBQSxNQUFBO0FBQUE7O2dCQURvQixDQUFiLEVBRGY7O0FBS0EsbUJBQU8sRUFQWDs7SUFGSjtXQVdBO0FBYkU7O0FBZU4sTUFBTSxDQUFDLE9BQVAsR0FDSTtJQUFBLElBQUEsRUFBSyxJQUFMO0lBQ0EsR0FBQSxFQUFJLEdBREoiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbiAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMDAwMDAgXG4wMDAgICAgICAgMDAwICAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgIDAwMCAgICAgIFxuMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAgICAgMDAwICAwMDAgIDAwMDBcbjAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgICAgIDAwMCAgMDAwICAgMDAwXG4gMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAwMDAwIFxuIyMjXG5cbnsgc2xhc2gsIG5vb24sIF8gfSA9IHJlcXVpcmUgJ2t4aydcblxucGF0aCA9IChrZXksIHAsIG9wdCkgLT5cbiAgICBcbiAgICB3aGlsZSBzbGFzaC5kaXIocCkubGVuZ3RoIGFuZCBzbGFzaC5kaXIocCkgbm90IGluIFsnLicgJy8nXVxuICAgICAgICBwID0gc2xhc2guZGlyIHBcbiAgICAgICAgaWYgc2xhc2guZmlsZUV4aXN0cyBzbGFzaC5qb2luIHAsICcua29ucmFkLm5vb24nXG4gICAgICAgICAgICBvID0gXy5kZWZhdWx0c0RlZXAgbm9vbi5sb2FkKHNsYXNoLmpvaW4gcCwgJy5rb25yYWQubm9vbicpLCBvcHRcbiAgICAgICAgICAgIGlmIG9ba2V5XT9cbiAgICAgICAgICAgICAgICByZXR1cm4gc2xhc2gucmVzb2x2ZSBwXG4gICAgbnVsbFxuXG5vYmogPSAocCwgb3B0PXt9KSAtPlxuICAgIFxuICAgIHdoaWxlIHNsYXNoLmRpcihwKS5sZW5ndGggYW5kIHNsYXNoLmRpcihwKSBub3QgaW4gWycuJyAnLyddIGFuZCBub3QgL15cXHdcXDpcXC8kLy50ZXN0IHNsYXNoLmRpcihwKVxuICAgICAgICBwID0gc2xhc2guZGlyIHBcbiAgICAgICAgaWYgc2xhc2guZmlsZUV4aXN0cyBzbGFzaC5qb2luIHAsICcua29ucmFkLm5vb24nXG4gICAgICAgICAgICBvID0gXy5kZWZhdWx0c0RlZXAgbm9vbi5sb2FkKHNsYXNoLmpvaW4gcCwgJy5rb25yYWQubm9vbicpLCBvcHRcbiAgICAgICAgICAgIGlmIG8uaWdub3JlPy5tYXA/XG4gICAgICAgICAgICAgICAgby5pZ25vcmUgPSBvLmlnbm9yZS5tYXAgKGkpIC0+XG4gICAgICAgICAgICAgICAgICAgIGlmIF8uaXNTdHJpbmcgaVxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFJlZ0V4cCBpXG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiBvXG4gICAgIyBrbG9nICdubyBvYmonIHBcbiAgICBvcHRcbiAgICBcbm1vZHVsZS5leHBvcnRzID0gXG4gICAgcGF0aDpwYXRoXG4gICAgb2JqOm9ialxuIl19
//# sourceURL=../coffee/config.coffee