// koffee 1.14.0

/*
000   000   0000000   000   000  00000000    0000000   0000000
000  000   000   000  0000  000  000   000  000   000  000   000
0000000    000   000  000 0 000  0000000    000000000  000   000
000  000   000   000  000  0000  000   000  000   000  000   000
000   000   0000000   000   000  000   000  000   000  0000000
 */
var _, actions, argDir, args, build, cmd, config, dirty, dotGit, fs, gitcount, gitup, j, klog, kolor, len, noon, opt, optall, pkg, pretty, ref, ref1, runcmd, should, slash, status, walk, watch, wlk;

ref = require('kxk'), _ = ref._, args = ref.args, fs = ref.fs, klog = ref.klog, kolor = ref.kolor, noon = ref.noon, slash = ref.slash, watch = ref.watch;

argDir = require('./argdir');

build = require('./build');

config = require('./config');

pretty = require('./pretty');

runcmd = require('./runcmd');

should = require('./should');

status = require('./status');

watch = require('./watch');

walk = require('./walk');

pkg = require(__dirname + "/../package");

args = args.init("arguments  depend on options                            **\nrun        build dirty or missing targets in dir        false\nrebuild    rebuild all targets in dir                   false  -R\nwatch      watch directory for changes                  false\ninfo       show build status of dir                     false\nbump       bump package.* version [major|minor|patch]   false\nbuild      make package                                 false  -m\ndiff       show git diff of file/dir                    false\nstatus     show git status of file/dir                  false\nfetch      fetch and show git status of file/dir        false\ncommit     add, commit and push [msg]                   false\nupdate     update npm packages                          false\npublish    bump, commit & publish to npm [msg]          false\ntest       run tests                                    false\nverbose    log more                                     false\nquiet      log nothing                                  false\ndebug      log debug                                    false  -D\nlogtime    log with time                                true", {
    pkg: pkg
});

actions = ['bump', 'build', 'commit', 'publish', 'update', 'test', 'watch', 'run', 'rebuild', 'info', 'status', 'fetch', 'diff'];

if (!actions.map(function(a) {
    return args[a];
}).reduce(function(acc, val) {
    return acc || val;
})) {
    args.run = true;
}

opt = noon.parse("coffee  . ext js   . map true . replace .. /coffee/ /js/ .. ^coffee/ js/ \nkoffee  . ext js   . map true . replace .. /coffee/ /js/ .. ^coffee/ js/ \nnoon    . ext json\njson    . ext noon . filter  .. package.json$\nstyl    . ext css  . replace .. /style/ /css/ .. /styl/ /js/css/\npug     . ext html . replace .. /pug/ /js/");

opt.ignore = [/.*\.konrad\.noon$/, /.*menu\.noon$/];

wlk = {
    ignore: [/node_modules$/, /bower_components$/, /\/img$/, /\/\..+$/, /\.git$/, /\.app$/, /.*-x64$/, /.*-ia32$/, /\/?inno$/, /\/?js$/]
};

dirty = function(sourceFile, targetFile) {
    var ss, ts;
    if (!fs.existsSync(targetFile)) {
        return true;
    }
    ss = fs.statSync(sourceFile);
    ts = fs.statSync(targetFile);
    return ss.mtime.getTime() > ts.mtime.getTime();
};

if (args.info) {
    console.log(kolor.gray('‚óã‚óè info'));
    walk(wlk, opt, function(sourceFile, targetFile) {
        if (args.verbose) {
            console.log("source: " + sourceFile + " target: " + targetFile);
        }
        if (dirty(sourceFile, targetFile)) {
            return console.log(pretty.filePath(_.padEnd(slash.relative(sourceFile, argDir()), 40), kolor.yellow), kolor.red(kolor.dim(" ‚ñ∫ ")), pretty.filePath(slash.relative(targetFile, argDir()), kolor.red));
        } else if (args.verbose) {
            return console.log(pretty.filePath(_.padEnd(slash.relative(sourceFile, argDir()), 40), kolor.magenta), kolor.green(kolor.dim(" ‚ñ∫ ")), pretty.filePath(slash.relative(targetFile, argDir()), kolor.green));
        }
    });
}

if (args.diff) {
    args.status = true;
}

if (args.status || args.fetch) {
    optall = _.defaults(opt, {
        all: true
    });
    gitcount = 0;
    walk(wlk, optall, function(sourceFile, targetFile) {
        var i, j, len, ref1;
        if (!targetFile) {
            if (slash.basename(sourceFile) === '.git') {
                if (args.fetch) {
                    status.gitFetch(sourceFile);
                } else {
                    status.gitStatus(sourceFile);
                }
                gitcount += 1;
            }
            if (slash.dirExists(sourceFile)) {
                ref1 = opt.ignore;
                for (j = 0, len = ref1.length; j < len; j++) {
                    i = ref1[j];
                    if ((i != null ? i.test : void 0) != null) {
                        if (i.test(sourceFile)) {
                            return false;
                        }
                    } else {
                        klog('ignore?', i);
                    }
                }
            }
        }
        return true;
    });
    if (!gitcount) {
        gitup = slash.parse(argDir());
        while (gitup.base) {
            dotGit = slash.join(gitup.dir, '.git');
            if (fs.existsSync(dotGit)) {
                if (args.fetch) {
                    status.gitFetch(dotGit);
                } else {
                    status.gitStatus(dotGit);
                }
                break;
            }
            gitup = slash.parse(gitup.dir);
        }
    }
}

if (args.run || args.rebuild) {
    if (!args.quiet) {
        console.log('üîßüîß ' + kolor.gray(args.rebuild && 'rebuild' || 'run'));
    }
    walk(wlk, opt, function(sourceFile, targetFile) {
        var isDirty, src, tgt;
        if (targetFile) {
            isDirty = dirty(sourceFile, targetFile);
            if (args.rebuild || isDirty) {
                src = pretty.filePath(_.padEnd(slash.relative(sourceFile, argDir()), 40), isDirty && kolor.red || kolor.yellow);
                tgt = pretty.filePath(slash.relative(targetFile, argDir()), kolor.green);
                if (!args.quiet) {
                    console.log(src, "üîß  ", tgt);
                }
                return build(sourceFile, opt, function(sourceFile, targetFile) {
                    var o;
                    if (!targetFile) {
                        process.exit(1);
                    }
                    o = config.obj(targetFile, opt);
                    if (should('browserify', o, targetFile)) {
                        console.log(pretty.filePath(_.padEnd(slash.relative(o.browserify.main, argDir()), 40), kolor.yellow), "üîß  ", pretty.filePath(slash.relative(o.browserify.out, argDir()), kolor.blue));
                        return runcmd('browserify', o.browserify.main + " " + o.browserify.out, config.path('browserify', slash.resolve(targetFile), opt));
                    }
                });
            }
        }
    });
}

ref1 = ['update', 'bump', 'build', 'commit', 'publish', 'test'];
for (j = 0, len = ref1.length; j < len; j++) {
    cmd = ref1[j];
    if (args[cmd]) {
        if (!runcmd(cmd, args["arguments"].join(' '), process.cwd())) {
            process.exit(1);
            break;
        }
        if (args.verbose) {
            console.log(kolor.gray('üîß  done'));
        }
        if (args["arguments"] && (cmd === 'commit' || cmd === 'bump' || cmd === 'build')) {
            break;
        }
    }
}

if (args.watch) {
    watch(wlk, opt);
} else if (cmd === 'build') {
    process.exit(0);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia29ucmFkLmpzIiwic291cmNlUm9vdCI6Ii4uL2NvZmZlZSIsInNvdXJjZXMiOlsia29ucmFkLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQTs7QUFRQSxNQUFtRCxPQUFBLENBQVEsS0FBUixDQUFuRCxFQUFFLFNBQUYsRUFBSyxlQUFMLEVBQVcsV0FBWCxFQUFlLGVBQWYsRUFBcUIsaUJBQXJCLEVBQTRCLGVBQTVCLEVBQWtDLGlCQUFsQyxFQUF5Qzs7QUFFekMsTUFBQSxHQUFTLE9BQUEsQ0FBUSxVQUFSOztBQUNULEtBQUEsR0FBUyxPQUFBLENBQVEsU0FBUjs7QUFDVCxNQUFBLEdBQVMsT0FBQSxDQUFRLFVBQVI7O0FBQ1QsTUFBQSxHQUFTLE9BQUEsQ0FBUSxVQUFSOztBQUNULE1BQUEsR0FBUyxPQUFBLENBQVEsVUFBUjs7QUFDVCxNQUFBLEdBQVMsT0FBQSxDQUFRLFVBQVI7O0FBQ1QsTUFBQSxHQUFTLE9BQUEsQ0FBUSxVQUFSOztBQUNULEtBQUEsR0FBUyxPQUFBLENBQVEsU0FBUjs7QUFDVCxJQUFBLEdBQVMsT0FBQSxDQUFRLFFBQVI7O0FBQ1QsR0FBQSxHQUFTLE9BQUEsQ0FBVyxTQUFELEdBQVcsYUFBckI7O0FBRVQsSUFBQSxHQUFPLElBQUksQ0FBQyxJQUFMLENBQVUsc25DQUFWLEVBbUJFO0lBQUEsR0FBQSxFQUFJLEdBQUo7Q0FuQkY7O0FBcUJQLE9BQUEsR0FBVSxDQUFDLE1BQUQsRUFBUSxPQUFSLEVBQWdCLFFBQWhCLEVBQXlCLFNBQXpCLEVBQW1DLFFBQW5DLEVBQTRDLE1BQTVDLEVBQW1ELE9BQW5ELEVBQTJELEtBQTNELEVBQWlFLFNBQWpFLEVBQTJFLE1BQTNFLEVBQWtGLFFBQWxGLEVBQTJGLE9BQTNGLEVBQW1HLE1BQW5HOztBQUVWLElBQUcsQ0FBSSxPQUFPLENBQUMsR0FBUixDQUFZLFNBQUMsQ0FBRDtXQUFPLElBQUssQ0FBQSxDQUFBO0FBQVosQ0FBWixDQUEyQixDQUFD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OztRQUVBLElBQUcsSUFBSSxFQUFDLFNBQUQsRUFBSixJQUFtQixDQUFBLEdBQUEsS0FBUSxRQUFSLElBQUEsR0FBQSxLQUFpQixNQUFqQixJQUFBLEdBQUEsS0FBd0IsT0FBeEIsQ0FBdEI7QUFDSSxrQkFESjtTQVJKOztBQUZKOztBQWFBLElBQUcsSUFBSSxDQUFDLEtBQVI7SUFDSSxLQUFBLENBQU0sR0FBTixFQUFXLEdBQVgsRUFESjtDQUFBLE1BRUssSUFBRyxHQUFBLEtBQVEsT0FBWDtJQUNELE9BQU8sQ0FBQyxJQUFSLENBQWEsQ0FBYixFQURDIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4wMDAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwMDAwMFxuMDAwICAwMDAgICAwMDAgICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuMDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMCAwIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMCAgIDAwMFxuMDAwICAwMDAgICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMFxuMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDBcbiMjI1xuXG57IF8sIGFyZ3MsIGZzLCBrbG9nLCBrb2xvciwgbm9vbiwgc2xhc2gsIHdhdGNoIH0gPSByZXF1aXJlICdreGsnXG5cbmFyZ0RpciA9IHJlcXVpcmUgJy4vYXJnZGlyJ1xuYnVpbGQgID0gcmVxdWlyZSAnLi9idWlsZCdcbmNvbmZpZyA9IHJlcXVpcmUgJy4vY29uZmlnJ1xucHJldHR5ID0gcmVxdWlyZSAnLi9wcmV0dHknXG5ydW5jbWQgPSByZXF1aXJlICcuL3J1bmNtZCcgXG5zaG91bGQgPSByZXF1aXJlICcuL3Nob3VsZCdcbnN0YXR1cyA9IHJlcXVpcmUgJy4vc3RhdHVzJ1xud2F0Y2ggID0gcmVxdWlyZSAnLi93YXRjaCdcbndhbGsgICA9IHJlcXVpcmUgJy4vd2FsaydcbnBrZyAgICA9IHJlcXVpcmUgXCIje19fZGlybmFtZX0vLi4vcGFja2FnZVwiXG5cbmFyZ3MgPSBhcmdzLmluaXQgXCJcIlwiXG4gICAgYXJndW1lbnRzICBkZXBlbmQgb24gb3B0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKlxuICAgIHJ1biAgICAgICAgYnVpbGQgZGlydHkgb3IgbWlzc2luZyB0YXJnZXRzIGluIGRpciAgICAgICAgZmFsc2VcbiAgICByZWJ1aWxkICAgIHJlYnVpbGQgYWxsIHRhcmdldHMgaW4gZGlyICAgICAgICAgICAgICAgICAgIGZhbHNlICAtUlxuICAgIHdhdGNoICAgICAgd2F0Y2ggZGlyZWN0b3J5IGZvciBjaGFuZ2VzICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBpbmZvICAgICAgIHNob3cgYnVpbGQgc3RhdHVzIG9mIGRpciAgICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgYnVtcCAgICAgICBidW1wIHBhY2thZ2UuKiB2ZXJzaW9uIFttYWpvcnxtaW5vcnxwYXRjaF0gICBmYWxzZVxuICAgIGJ1aWxkICAgICAgbWFrZSBwYWNrYWdlICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UgIC1tXG4gICAgZGlmZiAgICAgICBzaG93IGdpdCBkaWZmIG9mIGZpbGUvZGlyICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIHN0YXR1cyAgICAgc2hvdyBnaXQgc3RhdHVzIG9mIGZpbGUvZGlyICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBmZXRjaCAgICAgIGZldGNoIGFuZCBzaG93IGdpdCBzdGF0dXMgb2YgZmlsZS9kaXIgICAgICAgIGZhbHNlXG4gICAgY29tbWl0ICAgICBhZGQsIGNvbW1pdCBhbmQgcHVzaCBbbXNnXSAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIHVwZGF0ZSAgICAgdXBkYXRlIG5wbSBwYWNrYWdlcyAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBwdWJsaXNoICAgIGJ1bXAsIGNvbW1pdCAmIHB1Ymxpc2ggdG8gbnBtIFttc2ddICAgICAgICAgIGZhbHNlXG4gICAgdGVzdCAgICAgICBydW4gdGVzdHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIHZlcmJvc2UgICAgbG9nIG1vcmUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBxdWlldCAgICAgIGxvZyBub3RoaW5nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgZGVidWcgICAgICBsb2cgZGVidWcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSAgLURcbiAgICBsb2d0aW1lICAgIGxvZyB3aXRoIHRpbWUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWVcbiAgICBcIlwiXCIsIHBrZzpwa2dcblxuYWN0aW9ucyA9IFsnYnVtcCcgJ2J1aWxkJyAnY29tbWl0JyAncHVibGlzaCcgJ3VwZGF0ZScgJ3Rlc3QnICd3YXRjaCcgJ3J1bicgJ3JlYnVpbGQnICdpbmZvJyAnc3RhdHVzJyAnZmV0Y2gnICdkaWZmJ11cblxuaWYgbm90IGFjdGlvbnMubWFwKChhKSAtPiBhcmdzW2FdKS5yZWR1Y2UoKGFjYyx2YWwpIC0+IGFjYyBvciB2YWwpXG4gICAgYXJncy5ydW4gPSB0cnVlICMgbWFrZXMgcnVuIHRoZSBkZWZhdWx0IGFjdGlvbiBpZiBubyBvdGhlciBhY3Rpb24gaXMgc2V0XG4gICAgXG4jIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgICAgMDAwMDAwMDAwICAgMDAwMDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgIDAwMCAgICAgMDAwXG4jIDAwMCAgIDAwMCAgMDAwMDAwMCAgIDAwMDAwMCAgICAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgMDAwICAgICAwMDAwMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgMDAwICAgICAgICAgIDAwMFxuIyAwMDAwMDAwICAgIDAwMDAwMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgIDAwMCAgICAgMDAwMDAwMFxuXG5vcHQgPSBub29uLnBhcnNlIFwiXCJcIlxuY29mZmVlICAuIGV4dCBqcyAgIC4gbWFwIHRydWUgLiByZXBsYWNlIC4uIC9jb2ZmZWUvIC9qcy8gLi4gXmNvZmZlZS8ganMvIFxua29mZmVlICAuIGV4dCBqcyAgIC4gbWFwIHRydWUgLiByZXBsYWNlIC4uIC9jb2ZmZWUvIC9qcy8gLi4gXmNvZmZlZS8ganMvIFxubm9vbiAgICAuIGV4dCBqc29uXG5qc29uICAgIC4gZXh0IG5vb24gLiBmaWx0ZXIgIC4uIHBhY2thZ2UuanNvbiRcbnN0eWwgICAgLiBleHQgY3NzICAuIHJlcGxhY2UgLi4gL3N0eWxlLyAvY3NzLyAuLiAvc3R5bC8gL2pzL2Nzcy9cbnB1ZyAgICAgLiBleHQgaHRtbCAuIHJlcGxhY2UgLi4gL3B1Zy8gL2pzL1xuXCJcIlwiXG5cbiMgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwXG4jIDAwMCAgMDAwICAgICAgICAwMDAwICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDBcbiMgMDAwICAwMDAgIDAwMDAgIDAwMCAwIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDBcbiMgMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMFxuIyAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwMDAwMDBcblxub3B0Lmlnbm9yZSA9IFtcbiAgICAvLipcXC5rb25yYWRcXC5ub29uJC9cbiAgICAvLiptZW51XFwubm9vbiQvXG5dXG5cbndsayA9XG4gICAgaWdub3JlOiBbXG4gICAgICAgIC9ub2RlX21vZHVsZXMkL1xuICAgICAgICAvYm93ZXJfY29tcG9uZW50cyQvXG4gICAgICAgIC9cXC9pbWckL1xuICAgICAgICAvXFwvXFwuLiskL1xuICAgICAgICAvXFwuZ2l0JC9cbiAgICAgICAgL1xcLmFwcCQvXG4gICAgICAgIC8uKi14NjQkL1xuICAgICAgICAvLiotaWEzMiQvXG4gICAgICAgIC9cXC8/aW5ubyQvXG4gICAgICAgIC9cXC8/anMkL1xuICAgIF1cblxuIyAwMDAwMDAwICAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMCAgIDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgICAwMDAgMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwICAgICAgIDAwMCAgICAgICAwMDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgICAgIDAwMFxuIyAwMDAwMDAwICAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgICAgIDAwMFxuXG5kaXJ0eSA9IChzb3VyY2VGaWxlLCB0YXJnZXRGaWxlKSAtPlxuICAgIFxuICAgIGlmIG5vdCBmcy5leGlzdHNTeW5jIHRhcmdldEZpbGUgdGhlbiByZXR1cm4gdHJ1ZVxuICAgIHNzID0gZnMuc3RhdFN5bmMgc291cmNlRmlsZVxuICAgIHRzID0gZnMuc3RhdFN5bmMgdGFyZ2V0RmlsZVxuICAgIHNzLm10aW1lLmdldFRpbWUoKSA+IHRzLm10aW1lLmdldFRpbWUoKVxuXG4jIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgIDAwMDAwMDBcbiMgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDBcbiMgMDAwICAwMDAgMCAwMDAgIDAwMDAwMCAgICAwMDAgICAwMDBcbiMgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgICAwMDAgICAwMDBcbiMgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwMDAwMFxuXG5pZiBhcmdzLmluZm9cblxuICAgIGxvZyBrb2xvci5ncmF5ICfil4vil48gaW5mbydcblxuICAgIHdhbGsgd2xrLCBvcHQsIChzb3VyY2VGaWxlLCB0YXJnZXRGaWxlKSAtPlxuXG4gICAgICAgIGxvZyBcInNvdXJjZTogI3tzb3VyY2VGaWxlfSB0YXJnZXQ6ICN7dGFyZ2V0RmlsZX1cIiBpZiBhcmdzLnZlcmJvc2VcbiAgICAgICAgaWYgZGlydHkgc291cmNlRmlsZSwgdGFyZ2V0RmlsZVxuICAgICAgICAgICAgbG9nIHByZXR0eS5maWxlUGF0aChfLnBhZEVuZChzbGFzaC5yZWxhdGl2ZShzb3VyY2VGaWxlLCBhcmdEaXIoKSksIDQwKSwga29sb3IueWVsbG93KSwga29sb3IucmVkKGtvbG9yLmRpbShcIiDilrogXCIpKSwgcHJldHR5LmZpbGVQYXRoKHNsYXNoLnJlbGF0aXZlKHRhcmdldEZpbGUsIGFyZ0RpcigpKSwga29sb3IucmVkKVxuICAgICAgICBlbHNlIGlmIGFyZ3MudmVyYm9zZVxuICAgICAgICAgICAgbG9nIHByZXR0eS5maWxlUGF0aChfLnBhZEVuZChzbGFzaC5yZWxhdGl2ZShzb3VyY2VGaWxlLCBhcmdEaXIoKSksIDQwKSwga29sb3IubWFnZW50YSksIGtvbG9yLmdyZWVuKGtvbG9yLmRpbShcIiDilrogXCIpKSwgcHJldHR5LmZpbGVQYXRoKHNsYXNoLnJlbGF0aXZlKHRhcmdldEZpbGUsIGFyZ0RpcigpKSwga29sb3IuZ3JlZW4pXG5cbmlmIGFyZ3MuZGlmZlxuICAgIFxuICAgIGFyZ3Muc3RhdHVzID0gdHJ1ZVxuXG4jIGtsb2cgYXJnc1xuICAgIFxuaWYgYXJncy5zdGF0dXMgb3IgYXJncy5mZXRjaFxuICAgIFxuICAgIG9wdGFsbCA9IF8uZGVmYXVsdHMgb3B0LCBhbGw6IHRydWVcbiAgICBnaXRjb3VudCA9IDBcblxuICAgIHdhbGsgd2xrLCBvcHRhbGwsIChzb3VyY2VGaWxlLCB0YXJnZXRGaWxlKSAtPlxuXG4gICAgICAgIGlmIG5vdCB0YXJnZXRGaWxlXG5cbiAgICAgICAgICAgIGlmIHNsYXNoLmJhc2VuYW1lKHNvdXJjZUZpbGUpID09ICcuZ2l0J1xuICAgICAgICAgICAgICAgIGlmIGFyZ3MuZmV0Y2hcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzLmdpdEZldGNoIHNvdXJjZUZpbGVcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1cy5naXRTdGF0dXMgc291cmNlRmlsZVxuICAgICAgICAgICAgICAgIGdpdGNvdW50ICs9IDFcblxuICAgICAgICAgICAgaWYgc2xhc2guZGlyRXhpc3RzIHNvdXJjZUZpbGVcbiAgICAgICAgICAgICAgICBmb3IgaSBpbiBvcHQuaWdub3JlXG4gICAgICAgICAgICAgICAgICAgIGlmIGk/LnRlc3Q/XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiBpLnRlc3Qgc291cmNlRmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBrbG9nICdpZ25vcmU/JyBpXG4gICAgICAgIHRydWVcblxuICAgIGlmIG5vdCBnaXRjb3VudFxuICAgICAgICBnaXR1cCA9IHNsYXNoLnBhcnNlIGFyZ0RpcigpXG4gICAgICAgIHdoaWxlIGdpdHVwLmJhc2VcbiAgICAgICAgICAgIGRvdEdpdCA9IHNsYXNoLmpvaW4gZ2l0dXAuZGlyLCAnLmdpdCdcbiAgICAgICAgICAgIGlmIGZzLmV4aXN0c1N5bmMgZG90R2l0XG4gICAgICAgICAgICAgICAgaWYgYXJncy5mZXRjaFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXMuZ2l0RmV0Y2ggZG90R2l0XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBzdGF0dXMuZ2l0U3RhdHVzIGRvdEdpdFxuICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICBnaXR1cCA9IHNsYXNoLnBhcnNlIGdpdHVwLmRpclxuICAgICAgICAgICAgXG4jIDAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAgICAwMDBcbiMgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMDAgIDAwMFxuIyAwMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDBcbiMgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgIDAwMFxuXG5pZiBhcmdzLnJ1biBvciBhcmdzLnJlYnVpbGRcblxuICAgIGlmIG5vdCBhcmdzLnF1aWV0XG4gICAgICAgIGxvZyAn8J+Up/CflKcgJyArIGtvbG9yLmdyYXkoYXJncy5yZWJ1aWxkIGFuZCAncmVidWlsZCcgb3IgJ3J1bicpXG4gICAgXG4gICAgd2FsayB3bGssIG9wdCwgKHNvdXJjZUZpbGUsIHRhcmdldEZpbGUpIC0+XG4gICAgICAgIGlmIHRhcmdldEZpbGVcbiAgICAgICAgICAgIGlzRGlydHkgPSBkaXJ0eSBzb3VyY2VGaWxlLCB0YXJnZXRGaWxlXG4gICAgICAgICAgICBpZiBhcmdzLnJlYnVpbGQgb3IgaXNEaXJ0eVxuICAgICAgICAgICAgICAgIHNyYyA9IHByZXR0eS5maWxlUGF0aChfLnBhZEVuZChzbGFzaC5yZWxhdGl2ZShzb3VyY2VGaWxlLCBhcmdEaXIoKSksIDQwKSwgaXNEaXJ0eSBhbmQga29sb3IucmVkIG9yIGtvbG9yLnllbGxvdylcbiAgICAgICAgICAgICAgICB0Z3QgPSBwcmV0dHkuZmlsZVBhdGgoc2xhc2gucmVsYXRpdmUodGFyZ2V0RmlsZSwgYXJnRGlyKCkpLCBrb2xvci5ncmVlbilcbiAgICAgICAgICAgICAgICBpZiBub3QgYXJncy5xdWlldFxuICAgICAgICAgICAgICAgICAgICBsb2cgc3JjLCBcIvCflKcgIFwiLCB0Z3RcbiAgICAgICAgICAgICAgICBidWlsZCBzb3VyY2VGaWxlLCBvcHQsIChzb3VyY2VGaWxlLCB0YXJnZXRGaWxlKSAtPlxuICAgICAgICAgICAgICAgICAgICBpZiBub3QgdGFyZ2V0RmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzcy5leGl0IDFcbiAgICAgICAgICAgICAgICAgICAgbyA9IGNvbmZpZy5vYmogdGFyZ2V0RmlsZSwgb3B0XG4gICAgICAgICAgICAgICAgICAgIGlmIHNob3VsZCAnYnJvd3NlcmlmeScsIG8sIHRhcmdldEZpbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nIHByZXR0eS5maWxlUGF0aChfLnBhZEVuZChzbGFzaC5yZWxhdGl2ZShvLmJyb3dzZXJpZnkubWFpbiwgYXJnRGlyKCkpLCA0MCksIGtvbG9yLnllbGxvdyksIFwi8J+UpyAgXCIsIHByZXR0eS5maWxlUGF0aChzbGFzaC5yZWxhdGl2ZShvLmJyb3dzZXJpZnkub3V0LCBhcmdEaXIoKSksIGtvbG9yLmJsdWUpXG4gICAgICAgICAgICAgICAgICAgICAgICBydW5jbWQgJ2Jyb3dzZXJpZnknIFwiI3tvLmJyb3dzZXJpZnkubWFpbn0gI3tvLmJyb3dzZXJpZnkub3V0fVwiIGNvbmZpZy5wYXRoICdicm93c2VyaWZ5Jywgc2xhc2gucmVzb2x2ZSh0YXJnZXRGaWxlKSwgb3B0XG5cbmZvciBjbWQgaW4gWyd1cGRhdGUnICdidW1wJyAnYnVpbGQnICdjb21taXQnICdwdWJsaXNoJyAndGVzdCddXG5cbiAgICBpZiBhcmdzW2NtZF1cblxuICAgICAgICBpZiBub3QgcnVuY21kIGNtZCwgYXJncy5hcmd1bWVudHMuam9pbignICcpLCBwcm9jZXNzLmN3ZCgpXG4gICAgICAgICAgICBwcm9jZXNzLmV4aXQgMVxuICAgICAgICAgICAgYnJlYWtcblxuICAgICAgICBsb2cga29sb3IuZ3JheSAn8J+UpyAgZG9uZScgaWYgYXJncy52ZXJib3NlXG5cbiAgICAgICAgaWYgYXJncy5hcmd1bWVudHMgYW5kIGNtZCBpbiBbJ2NvbW1pdCcgJ2J1bXAnICdidWlsZCddXG4gICAgICAgICAgICBicmVha1xuXG5pZiBhcmdzLndhdGNoXG4gICAgd2F0Y2ggd2xrLCBvcHRcbmVsc2UgaWYgY21kIGluIFsnYnVpbGQnXVxuICAgIHByb2Nlc3MuZXhpdCAwXG4gICAgIl19
//# sourceURL=../coffee/konrad.coffee