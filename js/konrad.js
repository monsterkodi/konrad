/*
000   000   0000000   000   000  00000000    0000000   0000000
000  000   000   000  0000  000  000   000  000   000  000   000
0000000    000   000  000 0 000  0000000    000000000  000   000
000  000   000   000  000  0000  000   000  000   000  000   000
000   000   0000000   000   000  000   000  000   000  0000000
*/
var _, actions, argDir, args, build, cmd, colors, config, dirty, dotGit, fs, gitcount, gitup, j, len, log, noon, opt, optall, pkg, pretty, ref, runcmd, should, slash, status, walk, watch, wlk;

({args, colors, slash, noon, fs, log, _} = require('kxk'));

argDir = require('./argdir');

build = require('./build');

config = require('./config');

pretty = require('./pretty');

runcmd = require('./runcmd');

should = require('./should');

status = require('./status');

watch = require('./watch');

walk = require('./walk');

pkg = require(`${__dirname}/../package`);

args = args.init("arguments  depend on options                            **\nrun        build dirty or missing targets in dir        false\nrebuild    rebuild all targets in dir                   false  -R\nwatch      watch directory for changes                  false\ninfo       show build status of dir                     false\nbump       bump package.* version [major|minor|patch]   false\ndiff       show git diff of file/dir                    false\nstatus     show git status of file/dir                  false\ncommit     add, commit and push [msg]                   false\nupdate     update npm packages                          false\npublish    bump, commit & publish to npm [msg]          false\ntest       run tests                                    false\nverbose    log more                                     false\nquiet      log nothing                                  false\ndebug      log debug                                    false  -D\nlogtime    log with time                                true");

actions = ['bump', 'commit', 'publish', 'update', 'test', 'watch', 'run', 'rebuild', 'info', 'status', 'diff'];

if (!actions.map(function(a) {
  return args[a];
}).reduce(function(acc, val) {
  return acc || val;
})) {
  args.run = true; // makes run the default action if no other action is set
}


// 0000000    00000000  00000000   0000000   000   000  000      000000000   0000000
// 000   000  000       000       000   000  000   000  000         000     000
// 000   000  0000000   000000    000000000  000   000  000         000     0000000
// 000   000  000       000       000   000  000   000  000         000          000
// 0000000    00000000  000       000   000   0000000   0000000     000     0000000
opt = noon.parse("coffee  . ext js   . map true . replace .. /coffee/ /js/ .. ^coffee/ js/ \nnoon    . ext json\njson    . ext noon . filter  .. package.json$\nstyl    . ext css  . replace .. /style/ /css/ .. /styl/ /js/css/\npug     . ext html . replace .. /pug/ /js/");

// 000   0000000   000   000   0000000   00000000   00000000
// 000  000        0000  000  000   000  000   000  000
// 000  000  0000  000 0 000  000   000  0000000    0000000
// 000  000   000  000  0000  000   000  000   000  000
// 000   0000000   000   000   0000000   000   000  00000000
opt.ignore = [/gulpfile.coffee$/, /Gruntfile.coffee$/, /\.konrad\.noon$/, /menu.noon$/];

wlk = {
  ignore: [/node_modules$/, /bower_components$/, /\/img$/, /\/\..+$/, /\.git$/, /\.app$/, /.*-x64$/, /.*-ia32$/, /\/?inno$/, /\/?js$/]
};

// 0000000    000  00000000   000000000  000   000
// 000   000  000  000   000     000      000 000
// 000   000  000  0000000       000       00000
// 000   000  000  000   000     000        000
// 0000000    000  000   000     000        000
dirty = function(sourceFile, targetFile) {
  var ss, ts;
  if (!fs.existsSync(targetFile)) {
    return true;
  }
  ss = fs.statSync(sourceFile);
  ts = fs.statSync(targetFile);
  return ss.mtime.getTime() > ts.mtime.getTime();
};

// 000  000   000  00000000   0000000
// 000  0000  000  000       000   000
// 000  000 0 000  000000    000   000
// 000  000  0000  000       000   000
// 000  000   000  000        0000000
if (args.info) {
  console.log('‚óã‚óè info'.gray);
  walk(wlk, opt, function(sourceFile, targetFile) {
    if (args.verbose) {
      log(`source: ${sourceFile} target: ${targetFile}`);
    }
    if (dirty(sourceFile, targetFile)) {
      return console.log(pretty.filePath(_.padEnd(slash.relative(sourceFile, argDir()), 40), colors.yellow), " ‚ñ∫ ".red.dim, pretty.filePath(slash.relative(targetFile, argDir()), colors.red));
    } else if (args.verbose) {
      return console.log(pretty.filePath(_.padEnd(slash.relative(sourceFile, argDir()), 40), colors.magenta), " ‚ñ∫ ".green.dim, pretty.filePath(slash.relative(targetFile, argDir()), colors.green));
    }
  });
}

if (args.diff) {
  args.status = true;
}

if (args.status) {
  optall = _.defaults(opt, {
    all: true
  });
  gitcount = 0;
  walk(wlk, optall, function(sourceFile, targetFile) {
    var i, j, len, ref;
    if (!targetFile) {
      if (slash.basename(sourceFile) === '.git') {
        status.gitStatus(sourceFile);
        gitcount += 1;
      }
      if (slash.dirExists(sourceFile)) {
        ref = opt.ignore;
        for (j = 0, len = ref.length; j < len; j++) {
          i = ref[j];
          if (i.test(sourceFile)) {
            return false;
          }
        }
      }
    }
    return true;
  });
  if (!gitcount) {
    gitup = slash.parse(argDir());
    while (gitup.base) {
      dotGit = slash.join(gitup.dir, '.git');
      if (fs.existsSync(dotGit)) {
        status.gitStatus(dotGit);
        break;
      }
      gitup = slash.parse(gitup.dir);
    }
  }
}

// 00000000   000   000  000   000
// 000   000  000   000  0000  000
// 0000000    000   000  000 0 000
// 000   000  000   000  000  0000
// 000   000   0000000   000   000
if (args.run || args.rebuild) {
  console.log('üîßüîß ' + (args.rebuild && 'rebuild' || 'run').gray);
  walk(wlk, opt, function(sourceFile, targetFile) {
    var isDirty, src, tgt;
    if (targetFile) {
      isDirty = dirty(sourceFile, targetFile);
      if (args.rebuild || isDirty) {
        src = pretty.filePath(_.padEnd(slash.relative(sourceFile, argDir()), 40), isDirty && colors.red || colors.yellow);
        tgt = pretty.filePath(slash.relative(targetFile, argDir()), colors.green);
        console.log(src, "üîß  ", tgt);
        return build(sourceFile, opt, function(sourceFile, targetFile) {
          var o;
          o = config.obj(targetFile, opt);
          if (should('browserify', o, targetFile)) {
            console.log(pretty.filePath(_.padEnd(slash.relative(o.browserify.main, argDir()), 40), colors.yellow), "üîß  ", pretty.filePath(slash.relative(o.browserify.out, argDir()), colors.blue));
            return runcmd('browserify', `${o.browserify.main} ${o.browserify.out}`, config.path('browserify', slash.resolve(targetFile), opt));
          }
        });
      }
    }
  });
}

ref = ['update', 'bump', 'commit', 'publish', 'test'];
for (j = 0, len = ref.length; j < len; j++) {
  cmd = ref[j];
  if (args[cmd]) {
    if (!runcmd(cmd, args.arguments.join(' ', process.cwd()))) {
      break;
    }
    if (args.verbose) {
      console.log('üîß  done'.gray);
    }
    if (args.arguments && (cmd === 'commit' || cmd === 'bump')) {
      break;
    }
  }
}

if (args.watch) {
  watch(wlk, opt);
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia29ucmFkLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIi4uL2NvZmZlZS9rb25yYWQuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7O0FBQUEsSUFBQSxDQUFBLEVBQUEsT0FBQSxFQUFBLE1BQUEsRUFBQSxJQUFBLEVBQUEsS0FBQSxFQUFBLEdBQUEsRUFBQSxNQUFBLEVBQUEsTUFBQSxFQUFBLEtBQUEsRUFBQSxNQUFBLEVBQUEsRUFBQSxFQUFBLFFBQUEsRUFBQSxLQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLEdBQUEsRUFBQSxNQUFBLEVBQUEsR0FBQSxFQUFBLE1BQUEsRUFBQSxHQUFBLEVBQUEsTUFBQSxFQUFBLE1BQUEsRUFBQSxLQUFBLEVBQUEsTUFBQSxFQUFBLElBQUEsRUFBQSxLQUFBLEVBQUE7O0FBUUEsQ0FBQSxDQUFFLElBQUYsRUFBUSxNQUFSLEVBQWdCLEtBQWhCLEVBQXVCLElBQXZCLEVBQTZCLEVBQTdCLEVBQWlDLEdBQWpDLEVBQXNDLENBQXRDLENBQUEsR0FBNEMsT0FBQSxDQUFRLEtBQVIsQ0FBNUM7O0FBRUEsTUFBQSxHQUFjLE9BQUEsQ0FBUSxVQUFSOztBQUNkLEtBQUEsR0FBYyxPQUFBLENBQVEsU0FBUjs7QUFDZCxNQUFBLEdBQWMsT0FBQSxDQUFRLFVBQVI7O0FBQ2QsTUFBQSxHQUFjLE9BQUEsQ0FBUSxVQUFSOztBQUNkLE1BQUEsR0FBYyxPQUFBLENBQVEsVUFBUjs7QUFDZCxNQUFBLEdBQWMsT0FBQSxDQUFRLFVBQVI7O0FBQ2QsTUFBQSxHQUFjLE9BQUEsQ0FBUSxVQUFSOztBQUNkLEtBQUEsR0FBYyxPQUFBLENBQVEsU0FBUjs7QUFDZCxJQUFBLEdBQWMsT0FBQSxDQUFRLFFBQVI7O0FBQ2QsR0FBQSxHQUFjLE9BQUEsQ0FBUSxDQUFBLENBQUEsQ0FBRyxTQUFILENBQWEsV0FBYixDQUFSOztBQUVkLElBQUEsR0FBTyxJQUFJLENBQUMsSUFBTCxDQUFVLG8vQkFBVjs7QUFtQlAsT0FBQSxHQUFVLENBQUMsTUFBRCxFQUFTLFFBQVQsRUFBbUIsU0FBbkIsRUFBOEIsUUFBOUIsRUFBd0MsTUFBeEMsRUFBZ0QsT0FBaEQsRUFBeUQsS0FBekQsRUFBZ0UsU0FBaEUsRUFBMkUsTUFBM0UsRUFBbUYsUUFBbkYsRUFBNkYsTUFBN0Y7O0FBRVYsSUFBRyxDQUFJLE9BQU8sQ0FBQyxHQUFSLENBQVksUUFBQSxDQUFDLENBQUQsQ0FBQTtTQUFPLElBQUssQ0FBQSxDQUFBO0FBQVosQ0FBWixDQUEyQixDQUFDLE1BQTVCLENBQW1DLFFBQUEsQ0FBQyxHQUFELEVBQUssR0FBTCxDQUFBO1NBQWEsR0FBQSxJQUFPO0FBQXBCLENBQW5DLENBQVA7RUFDSSxJQUFJLENBQUMsR0FBTCxHQUFXLEtBRGY7Q0ExQ0E7Ozs7Ozs7O0FBbURBLEdBQUEsR0FBTSxJQUFJLENBQUMsS0FBTCxDQUFXLDRQQUFYLEVBbkROOzs7Ozs7O0FBaUVBLEdBQUcsQ0FBQyxNQUFKLEdBQWEsQ0FDVCxrQkFEUyxFQUVULG1CQUZTLEVBR1QsaUJBSFMsRUFJVCxZQUpTOztBQU9iLEdBQUEsR0FDSTtFQUFBLE1BQUEsRUFBUSxDQUNKLGVBREksRUFFSixtQkFGSSxFQUdKLFFBSEksRUFJSixTQUpJLEVBS0osUUFMSSxFQU1KLFFBTkksRUFPSixTQVBJLEVBUUosVUFSSSxFQVNKLFVBVEksRUFVSixRQVZJO0FBQVIsRUF6RUo7Ozs7Ozs7QUE0RkEsS0FBQSxHQUFRLFFBQUEsQ0FBQyxVQUFELEVBQWEsVUFBYixDQUFBO0FBRUosTUFBQSxFQUFBLEVBQUE7RUFBQSxJQUFHLENBQUksRUFBRSxDQUFDLFVBQUgsQ0FBYyxVQUFkLENBQVA7QUFBcUMsV0FBTyxLQUE1Qzs7RUFDQSxFQUFBLEdBQUssRUFBRSxDQUFDLFFBQUgsQ0FBWSxVQUFaO0VBQ0wsRUFBQSxHQUFLLEVBQUUsQ0FBQyxRQUFILENBQVksVUFBWjtTQUNMLEVBQUUsQ0FBQyxLQUFLLENBQUMsT0FBVCxDQUFBLENBQUEsR0FBcUIsRUFBRSxDQUFDLEtBQUssQ0FBQyxPQUFULENBQUE7QUFMakIsRUE1RlI7Ozs7Ozs7QUF5R0EsSUFBRyxJQUFJLENBQUMsSUFBUjtFQUVJLE9BQU8sQ0FBQyxHQUFSLENBQVksU0FBUyxDQUFDLElBQXRCO0VBRUEsSUFBQSxDQUFLLEdBQUwsRUFBVSxHQUFWLEVBQWUsUUFBQSxDQUFDLFVBQUQsRUFBYSxVQUFiLENBQUE7SUFFWCxJQUFxRCxJQUFJLENBQUMsT0FBMUQ7TUFBQSxHQUFBLENBQUksQ0FBQSxRQUFBLENBQUEsQ0FBVyxVQUFYLENBQXNCLFNBQXRCLENBQUEsQ0FBaUMsVUFBakMsQ0FBQSxDQUFKLEVBQUE7O0lBQ0EsSUFBRyxLQUFBLENBQU0sVUFBTixFQUFrQixVQUFsQixDQUFIO2FBQ0ksT0FBTyxDQUFDLEdBQVIsQ0FBWSxNQUFNLENBQUMsUUFBUCxDQUFnQixDQUFDLENBQUMsTUFBRixDQUFTLEtBQUssQ0FBQyxRQUFOLENBQWUsVUFBZixFQUEyQixNQUFBLENBQUEsQ0FBM0IsQ0FBVCxFQUErQyxFQUEvQyxDQUFoQixFQUFvRSxNQUFNLENBQUMsTUFBM0UsQ0FBWixFQUFnRyxLQUFLLENBQUMsR0FBRyxDQUFDLEdBQTFHLEVBQStHLE1BQU0sQ0FBQyxRQUFQLENBQWdCLEtBQUssQ0FBQyxRQUFOLENBQWUsVUFBZixFQUEyQixNQUFBLENBQUEsQ0FBM0IsQ0FBaEIsRUFBc0QsTUFBTSxDQUFDLEdBQTdELENBQS9HLEVBREo7S0FBQSxNQUVLLElBQUcsSUFBSSxDQUFDLE9BQVI7YUFDRCxPQUFPLENBQUMsR0FBUixDQUFZLE1BQU0sQ0FBQyxRQUFQLENBQWdCLENBQUMsQ0FBQyxNQUFGLENBQVMsS0FBSyxDQUFDLFFBQU4sQ0FBZSxVQUFmLEVBQTJCLE1BQUEsQ0FBQSxDQUEzQixDQUFULEVBQStDLEVBQS9DLENBQWhCLEVBQW9FLE1BQU0sQ0FBQyxPQUEzRSxDQUFaLEVBQWlHLEtBQUssQ0FBQyxLQUFLLENBQUMsR0FBN0csRUFBa0gsTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsS0FBSyxDQUFDLFFBQU4sQ0FBZSxVQUFmLEVBQTJCLE1BQUEsQ0FBQSxDQUEzQixDQUFoQixFQUFzRCxNQUFNLENBQUMsS0FBN0QsQ0FBbEgsRUFEQzs7RUFMTSxDQUFmLEVBSko7OztBQVlBLElBQUcsSUFBSSxDQUFDLElBQVI7RUFFSSxJQUFJLENBQUMsTUFBTCxHQUFlLEtBRm5COzs7QUFJQSxJQUFHLElBQUksQ0FBQyxNQUFSO0VBRUksTUFBQSxHQUFTLENBQUMsQ0FBQyxRQUFGLENBQVcsR0FBWCxFQUFnQjtJQUFBLEdBQUEsRUFBSztFQUFMLENBQWhCO0VBQ1QsUUFBQSxHQUFXO0VBRVgsSUFBQSxDQUFLLEdBQUwsRUFBVSxNQUFWLEVBQWtCLFFBQUEsQ0FBQyxVQUFELEVBQWEsVUFBYixDQUFBO0FBRWQsUUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQTtJQUFBLElBQUcsQ0FBSSxVQUFQO01BRUksSUFBRyxLQUFLLENBQUMsUUFBTixDQUFlLFVBQWYsQ0FBQSxLQUE4QixNQUFqQztRQUNJLE1BQU0sQ0FBQyxTQUFQLENBQWlCLFVBQWpCO1FBQ0EsUUFBQSxJQUFZLEVBRmhCOztNQUlBLElBQUcsS0FBSyxDQUFDLFNBQU4sQ0FBZ0IsVUFBaEIsQ0FBSDtBQUNJO1FBQUEsS0FBQSxxQ0FBQTs7VUFDSSxJQUFHLENBQUMsQ0FBQyxJQUFGLENBQU8sVUFBUCxDQUFIO0FBQ0ksbUJBQU8sTUFEWDs7UUFESixDQURKO09BTko7O1dBVUE7RUFaYyxDQUFsQjtFQWNBLElBQUcsQ0FBSSxRQUFQO0lBQ0ksS0FBQSxHQUFRLEtBQUssQ0FBQyxLQUFOLENBQVksTUFBQSxDQUFBLENBQVo7QUFDUixXQUFNLEtBQUssQ0FBQyxJQUFaO01BQ0ksTUFBQSxHQUFTLEtBQUssQ0FBQyxJQUFOLENBQVcsS0FBSyxDQUFDLEdBQWpCLEVBQXNCLE1BQXRCO01BQ1QsSUFBRyxFQUFFLENBQUMsVUFBSCxDQUFjLE1BQWQsQ0FBSDtRQUNJLE1BQU0sQ0FBQyxTQUFQLENBQWlCLE1BQWpCO0FBQ0EsY0FGSjs7TUFHQSxLQUFBLEdBQVEsS0FBSyxDQUFDLEtBQU4sQ0FBWSxLQUFLLENBQUMsR0FBbEI7SUFMWixDQUZKO0dBbkJKO0NBekhBOzs7Ozs7O0FBMkpBLElBQUcsSUFBSSxDQUFDLEdBQUwsSUFBWSxJQUFJLENBQUMsT0FBcEI7RUFFSSxPQUFPLENBQUMsR0FBUixDQUFZLE9BQUEsR0FBVSxDQUFDLElBQUksQ0FBQyxPQUFMLElBQWlCLFNBQWpCLElBQThCLEtBQS9CLENBQXFDLENBQUMsSUFBNUQ7RUFFQSxJQUFBLENBQUssR0FBTCxFQUFVLEdBQVYsRUFBZSxRQUFBLENBQUMsVUFBRCxFQUFhLFVBQWIsQ0FBQTtBQUNYLFFBQUEsT0FBQSxFQUFBLEdBQUEsRUFBQTtJQUFBLElBQUcsVUFBSDtNQUNJLE9BQUEsR0FBVSxLQUFBLENBQU0sVUFBTixFQUFrQixVQUFsQjtNQUNWLElBQUcsSUFBSSxDQUFDLE9BQUwsSUFBZ0IsT0FBbkI7UUFDSSxHQUFBLEdBQU0sTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsQ0FBQyxDQUFDLE1BQUYsQ0FBUyxLQUFLLENBQUMsUUFBTixDQUFlLFVBQWYsRUFBMkIsTUFBQSxDQUFBLENBQTNCLENBQVQsRUFBK0MsRUFBL0MsQ0FBaEIsRUFBb0UsT0FBQSxJQUFZLE1BQU0sQ0FBQyxHQUFuQixJQUEwQixNQUFNLENBQUMsTUFBckc7UUFDTixHQUFBLEdBQU0sTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsS0FBSyxDQUFDLFFBQU4sQ0FBZSxVQUFmLEVBQTJCLE1BQUEsQ0FBQSxDQUEzQixDQUFoQixFQUFzRCxNQUFNLENBQUMsS0FBN0Q7UUFDTixPQUFPLENBQUMsR0FBUixDQUFZLEdBQVosRUFBaUIsTUFBakIsRUFBeUIsR0FBekI7ZUFDQSxLQUFBLENBQU0sVUFBTixFQUFrQixHQUFsQixFQUF1QixRQUFBLENBQUMsVUFBRCxFQUFhLFVBQWIsQ0FBQTtBQUNuQixjQUFBO1VBQUEsQ0FBQSxHQUFJLE1BQU0sQ0FBQyxHQUFQLENBQVcsVUFBWCxFQUF1QixHQUF2QjtVQUNKLElBQUcsTUFBQSxDQUFPLFlBQVAsRUFBcUIsQ0FBckIsRUFBd0IsVUFBeEIsQ0FBSDtZQUNJLE9BQU8sQ0FBQyxHQUFSLENBQVksTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsQ0FBQyxDQUFDLE1BQUYsQ0FBUyxLQUFLLENBQUMsUUFBTixDQUFlLENBQUMsQ0FBQyxVQUFVLENBQUMsSUFBNUIsRUFBa0MsTUFBQSxDQUFBLENBQWxDLENBQVQsRUFBc0QsRUFBdEQsQ0FBaEIsRUFBMkUsTUFBTSxDQUFDLE1BQWxGLENBQVosRUFBdUcsTUFBdkcsRUFBK0csTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsS0FBSyxDQUFDLFFBQU4sQ0FBZSxDQUFDLENBQUMsVUFBVSxDQUFDLEdBQTVCLEVBQWlDLE1BQUEsQ0FBQSxDQUFqQyxDQUFoQixFQUE0RCxNQUFNLENBQUMsSUFBbkUsQ0FBL0c7bUJBQ0EsTUFBQSxDQUFPLFlBQVAsRUFBcUIsQ0FBQSxDQUFBLENBQUcsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxJQUFoQixFQUFBLENBQUEsQ0FBd0IsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxHQUFyQyxDQUFBLENBQXJCLEVBQWlFLE1BQU0sQ0FBQyxJQUFQLENBQVksWUFBWixFQUEwQixLQUFLLENBQUMsT0FBTixDQUFjLFVBQWQsQ0FBMUIsRUFBcUQsR0FBckQsQ0FBakUsRUFGSjs7UUFGbUIsQ0FBdkIsRUFKSjtPQUZKOztFQURXLENBQWYsRUFKSjs7O0FBaUJBO0FBQUEsS0FBQSxxQ0FBQTs7RUFFSSxJQUFHLElBQUssQ0FBQSxHQUFBLENBQVI7SUFFSSxJQUFHLENBQUksTUFBQSxDQUFPLEdBQVAsRUFBWSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQWYsQ0FBb0IsR0FBcEIsRUFBeUIsT0FBTyxDQUFDLEdBQVIsQ0FBQSxDQUF6QixDQUFaLENBQVA7QUFDSSxZQURKOztJQUdBLElBQStCLElBQUksQ0FBQyxPQUFwQztNQUFBLE9BQU8sQ0FBQyxHQUFSLENBQVksVUFBVSxDQUFDLElBQXZCLEVBQUE7O0lBRUEsSUFBRyxJQUFJLENBQUMsU0FBTCxJQUFtQixDQUFBLEdBQUEsS0FBUSxRQUFSLElBQUEsR0FBQSxLQUFrQixNQUFsQixDQUF0QjtBQUNJLFlBREo7S0FQSjs7QUFGSjs7QUFZQSxJQUFHLElBQUksQ0FBQyxLQUFSO0VBQ0ksS0FBQSxDQUFNLEdBQU4sRUFBVyxHQUFYLEVBREoiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbjAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMDAwMDAwICAgIDAwMDAwMDAgICAwMDAwMDAwXG4wMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4wMDAwMDAwICAgIDAwMCAgIDAwMCAgMDAwIDAgMDAwICAwMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwICAgMDAwXG4wMDAgIDAwMCAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4wMDAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwMDAwMFxuIyMjXG5cbnsgYXJncywgY29sb3JzLCBzbGFzaCwgbm9vbiwgZnMsIGxvZywgXyB9ID0gcmVxdWlyZSAna3hrJ1xuXG5hcmdEaXIgICAgICA9IHJlcXVpcmUgJy4vYXJnZGlyJ1xuYnVpbGQgICAgICAgPSByZXF1aXJlICcuL2J1aWxkJ1xuY29uZmlnICAgICAgPSByZXF1aXJlICcuL2NvbmZpZydcbnByZXR0eSAgICAgID0gcmVxdWlyZSAnLi9wcmV0dHknXG5ydW5jbWQgICAgICA9IHJlcXVpcmUgJy4vcnVuY21kJ1xuc2hvdWxkICAgICAgPSByZXF1aXJlICcuL3Nob3VsZCdcbnN0YXR1cyAgICAgID0gcmVxdWlyZSAnLi9zdGF0dXMnXG53YXRjaCAgICAgICA9IHJlcXVpcmUgJy4vd2F0Y2gnXG53YWxrICAgICAgICA9IHJlcXVpcmUgJy4vd2FsaydcbnBrZyAgICAgICAgID0gcmVxdWlyZSBcIiN7X19kaXJuYW1lfS8uLi9wYWNrYWdlXCJcblxuYXJncyA9IGFyZ3MuaW5pdCBcIlwiXCJcbiAgICBhcmd1bWVudHMgIGRlcGVuZCBvbiBvcHRpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICoqXG4gICAgcnVuICAgICAgICBidWlsZCBkaXJ0eSBvciBtaXNzaW5nIHRhcmdldHMgaW4gZGlyICAgICAgICBmYWxzZVxuICAgIHJlYnVpbGQgICAgcmVidWlsZCBhbGwgdGFyZ2V0cyBpbiBkaXIgICAgICAgICAgICAgICAgICAgZmFsc2UgIC1SXG4gICAgd2F0Y2ggICAgICB3YXRjaCBkaXJlY3RvcnkgZm9yIGNoYW5nZXMgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIGluZm8gICAgICAgc2hvdyBidWlsZCBzdGF0dXMgb2YgZGlyICAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBidW1wICAgICAgIGJ1bXAgcGFja2FnZS4qIHZlcnNpb24gW21ham9yfG1pbm9yfHBhdGNoXSAgIGZhbHNlXG4gICAgZGlmZiAgICAgICBzaG93IGdpdCBkaWZmIG9mIGZpbGUvZGlyICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIHN0YXR1cyAgICAgc2hvdyBnaXQgc3RhdHVzIG9mIGZpbGUvZGlyICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBjb21taXQgICAgIGFkZCwgY29tbWl0IGFuZCBwdXNoIFttc2ddICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgdXBkYXRlICAgICB1cGRhdGUgbnBtIHBhY2thZ2VzICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIHB1Ymxpc2ggICAgYnVtcCwgY29tbWl0ICYgcHVibGlzaCB0byBucG0gW21zZ10gICAgICAgICAgZmFsc2VcbiAgICB0ZXN0ICAgICAgIHJ1biB0ZXN0cyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlXG4gICAgdmVyYm9zZSAgICBsb2cgbW9yZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgIHF1aWV0ICAgICAgbG9nIG5vdGhpbmcgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2VcbiAgICBkZWJ1ZyAgICAgIGxvZyBkZWJ1ZyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlICAtRFxuICAgIGxvZ3RpbWUgICAgbG9nIHdpdGggdGltZSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZVxuICAgIFwiXCJcIlxuXG5hY3Rpb25zID0gWydidW1wJywgJ2NvbW1pdCcsICdwdWJsaXNoJywgJ3VwZGF0ZScsICd0ZXN0JywgJ3dhdGNoJywgJ3J1bicsICdyZWJ1aWxkJywgJ2luZm8nLCAnc3RhdHVzJywgJ2RpZmYnXVxuXG5pZiBub3QgYWN0aW9ucy5tYXAoKGEpIC0+IGFyZ3NbYV0pLnJlZHVjZSgoYWNjLHZhbCkgLT4gYWNjIG9yIHZhbClcbiAgICBhcmdzLnJ1biA9IHRydWUgIyBtYWtlcyBydW4gdGhlIGRlZmF1bHQgYWN0aW9uIGlmIG5vIG90aGVyIGFjdGlvbiBpcyBzZXRcbiAgICBcbiMgMDAwMDAwMCAgICAwMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAgICAgICAwMDAwMDAwMDAgICAwMDAwMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgMDAwICAgICAwMDBcbiMgMDAwICAgMDAwICAwMDAwMDAwICAgMDAwMDAwICAgIDAwMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgICAwMDAgICAgIDAwMDAwMDBcbiMgMDAwICAgMDAwICAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgICAwMDAgICAgICAgICAgMDAwXG4jIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgICAgMDAwICAgICAwMDAwMDAwXG5cbm9wdCA9IG5vb24ucGFyc2UgXCJcIlwiXG5jb2ZmZWUgIC4gZXh0IGpzICAgLiBtYXAgdHJ1ZSAuIHJlcGxhY2UgLi4gL2NvZmZlZS8gL2pzLyAuLiBeY29mZmVlLyBqcy8gXG5ub29uICAgIC4gZXh0IGpzb25cbmpzb24gICAgLiBleHQgbm9vbiAuIGZpbHRlciAgLi4gcGFja2FnZS5qc29uJFxuc3R5bCAgICAuIGV4dCBjc3MgIC4gcmVwbGFjZSAuLiAvc3R5bGUvIC9jc3MvIC4uIC9zdHlsLyAvanMvY3NzL1xucHVnICAgICAuIGV4dCBodG1sIC4gcmVwbGFjZSAuLiAvcHVnLyAvanMvXG5cIlwiXCJcblxuIyAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMDBcbiMgMDAwICAwMDAgICAgICAgIDAwMDAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMFxuIyAwMDAgIDAwMCAgMDAwMCAgMDAwIDAgMDAwICAwMDAgICAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMFxuIyAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwXG4jIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMFxuXG5vcHQuaWdub3JlID0gW1xuICAgIC9ndWxwZmlsZS5jb2ZmZWUkL1xuICAgIC9HcnVudGZpbGUuY29mZmVlJC9cbiAgICAvXFwua29ucmFkXFwubm9vbiQvXG4gICAgL21lbnUubm9vbiQvXG5dXG5cbndsayA9XG4gICAgaWdub3JlOiBbXG4gICAgICAgIC9ub2RlX21vZHVsZXMkL1xuICAgICAgICAvYm93ZXJfY29tcG9uZW50cyQvXG4gICAgICAgIC9cXC9pbWckL1xuICAgICAgICAvXFwvXFwuLiskL1xuICAgICAgICAvXFwuZ2l0JC9cbiAgICAgICAgL1xcLmFwcCQvXG4gICAgICAgIC8uKi14NjQkL1xuICAgICAgICAvLiotaWEzMiQvXG4gICAgICAgIC9cXC8/aW5ubyQvXG4gICAgICAgIC9cXC8/anMkL1xuICAgIF1cblxuIyAwMDAwMDAwICAgIDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMCAgIDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgICAwMDAgMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAwMDAwMDAwICAgICAgIDAwMCAgICAgICAwMDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgICAgIDAwMFxuIyAwMDAwMDAwICAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgICAgIDAwMFxuXG5kaXJ0eSA9IChzb3VyY2VGaWxlLCB0YXJnZXRGaWxlKSAtPlxuICAgIFxuICAgIGlmIG5vdCBmcy5leGlzdHNTeW5jIHRhcmdldEZpbGUgdGhlbiByZXR1cm4gdHJ1ZVxuICAgIHNzID0gZnMuc3RhdFN5bmMgc291cmNlRmlsZVxuICAgIHRzID0gZnMuc3RhdFN5bmMgdGFyZ2V0RmlsZVxuICAgIHNzLm10aW1lLmdldFRpbWUoKSA+IHRzLm10aW1lLmdldFRpbWUoKVxuXG4jIDAwMCAgMDAwICAgMDAwICAwMDAwMDAwMCAgIDAwMDAwMDBcbiMgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDBcbiMgMDAwICAwMDAgMCAwMDAgIDAwMDAwMCAgICAwMDAgICAwMDBcbiMgMDAwICAwMDAgIDAwMDAgIDAwMCAgICAgICAwMDAgICAwMDBcbiMgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwMDAwMFxuXG5pZiBhcmdzLmluZm9cblxuICAgIGNvbnNvbGUubG9nICfil4vil48gaW5mbycuZ3JheVxuXG4gICAgd2FsayB3bGssIG9wdCwgKHNvdXJjZUZpbGUsIHRhcmdldEZpbGUpIC0+XG5cbiAgICAgICAgbG9nIFwic291cmNlOiAje3NvdXJjZUZpbGV9IHRhcmdldDogI3t0YXJnZXRGaWxlfVwiIGlmIGFyZ3MudmVyYm9zZVxuICAgICAgICBpZiBkaXJ0eSBzb3VyY2VGaWxlLCB0YXJnZXRGaWxlXG4gICAgICAgICAgICBjb25zb2xlLmxvZyBwcmV0dHkuZmlsZVBhdGgoXy5wYWRFbmQoc2xhc2gucmVsYXRpdmUoc291cmNlRmlsZSwgYXJnRGlyKCkpLCA0MCksIGNvbG9ycy55ZWxsb3cpLCBcIiDilrogXCIucmVkLmRpbSwgcHJldHR5LmZpbGVQYXRoKHNsYXNoLnJlbGF0aXZlKHRhcmdldEZpbGUsIGFyZ0RpcigpKSwgY29sb3JzLnJlZClcbiAgICAgICAgZWxzZSBpZiBhcmdzLnZlcmJvc2VcbiAgICAgICAgICAgIGNvbnNvbGUubG9nIHByZXR0eS5maWxlUGF0aChfLnBhZEVuZChzbGFzaC5yZWxhdGl2ZShzb3VyY2VGaWxlLCBhcmdEaXIoKSksIDQwKSwgY29sb3JzLm1hZ2VudGEpLCBcIiDilrogXCIuZ3JlZW4uZGltLCBwcmV0dHkuZmlsZVBhdGgoc2xhc2gucmVsYXRpdmUodGFyZ2V0RmlsZSwgYXJnRGlyKCkpLCBjb2xvcnMuZ3JlZW4pXG5cbmlmIGFyZ3MuZGlmZlxuICAgIFxuICAgIGFyZ3Muc3RhdHVzICA9IHRydWVcblxuaWYgYXJncy5zdGF0dXNcbiAgICBcbiAgICBvcHRhbGwgPSBfLmRlZmF1bHRzIG9wdCwgYWxsOiB0cnVlXG4gICAgZ2l0Y291bnQgPSAwXG5cbiAgICB3YWxrIHdsaywgb3B0YWxsLCAoc291cmNlRmlsZSwgdGFyZ2V0RmlsZSkgLT5cblxuICAgICAgICBpZiBub3QgdGFyZ2V0RmlsZVxuXG4gICAgICAgICAgICBpZiBzbGFzaC5iYXNlbmFtZShzb3VyY2VGaWxlKSA9PSAnLmdpdCdcbiAgICAgICAgICAgICAgICBzdGF0dXMuZ2l0U3RhdHVzIHNvdXJjZUZpbGVcbiAgICAgICAgICAgICAgICBnaXRjb3VudCArPSAxXG5cbiAgICAgICAgICAgIGlmIHNsYXNoLmRpckV4aXN0cyBzb3VyY2VGaWxlXG4gICAgICAgICAgICAgICAgZm9yIGkgaW4gb3B0Lmlnbm9yZVxuICAgICAgICAgICAgICAgICAgICBpZiBpLnRlc3Qgc291cmNlRmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgIHRydWVcblxuICAgIGlmIG5vdCBnaXRjb3VudFxuICAgICAgICBnaXR1cCA9IHNsYXNoLnBhcnNlIGFyZ0RpcigpXG4gICAgICAgIHdoaWxlIGdpdHVwLmJhc2VcbiAgICAgICAgICAgIGRvdEdpdCA9IHNsYXNoLmpvaW4gZ2l0dXAuZGlyLCAnLmdpdCdcbiAgICAgICAgICAgIGlmIGZzLmV4aXN0c1N5bmMgZG90R2l0XG4gICAgICAgICAgICAgICAgc3RhdHVzLmdpdFN0YXR1cyBkb3RHaXRcbiAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICAgICAgZ2l0dXAgPSBzbGFzaC5wYXJzZSBnaXR1cC5kaXJcblxuIyAwMDAwMDAwMCAgIDAwMCAgIDAwMCAgMDAwICAgMDAwXG4jIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAwICAwMDBcbiMgMDAwMDAwMCAgICAwMDAgICAwMDAgIDAwMCAwIDAwMFxuIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwXG4jIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDBcblxuaWYgYXJncy5ydW4gb3IgYXJncy5yZWJ1aWxkXG5cbiAgICBjb25zb2xlLmxvZyAn8J+Up/CflKcgJyArIChhcmdzLnJlYnVpbGQgYW5kICdyZWJ1aWxkJyBvciAncnVuJykuZ3JheVxuICAgIFxuICAgIHdhbGsgd2xrLCBvcHQsIChzb3VyY2VGaWxlLCB0YXJnZXRGaWxlKSAtPlxuICAgICAgICBpZiB0YXJnZXRGaWxlXG4gICAgICAgICAgICBpc0RpcnR5ID0gZGlydHkgc291cmNlRmlsZSwgdGFyZ2V0RmlsZVxuICAgICAgICAgICAgaWYgYXJncy5yZWJ1aWxkIG9yIGlzRGlydHlcbiAgICAgICAgICAgICAgICBzcmMgPSBwcmV0dHkuZmlsZVBhdGgoXy5wYWRFbmQoc2xhc2gucmVsYXRpdmUoc291cmNlRmlsZSwgYXJnRGlyKCkpLCA0MCksIGlzRGlydHkgYW5kIGNvbG9ycy5yZWQgb3IgY29sb3JzLnllbGxvdylcbiAgICAgICAgICAgICAgICB0Z3QgPSBwcmV0dHkuZmlsZVBhdGgoc2xhc2gucmVsYXRpdmUodGFyZ2V0RmlsZSwgYXJnRGlyKCkpLCBjb2xvcnMuZ3JlZW4pXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cgc3JjLCBcIvCflKcgIFwiLCB0Z3RcbiAgICAgICAgICAgICAgICBidWlsZCBzb3VyY2VGaWxlLCBvcHQsIChzb3VyY2VGaWxlLCB0YXJnZXRGaWxlKSAtPlxuICAgICAgICAgICAgICAgICAgICBvID0gY29uZmlnLm9iaiB0YXJnZXRGaWxlLCBvcHRcbiAgICAgICAgICAgICAgICAgICAgaWYgc2hvdWxkICdicm93c2VyaWZ5JywgbywgdGFyZ2V0RmlsZVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cgcHJldHR5LmZpbGVQYXRoKF8ucGFkRW5kKHNsYXNoLnJlbGF0aXZlKG8uYnJvd3NlcmlmeS5tYWluLCBhcmdEaXIoKSksIDQwKSwgY29sb3JzLnllbGxvdyksIFwi8J+UpyAgXCIsIHByZXR0eS5maWxlUGF0aChzbGFzaC5yZWxhdGl2ZShvLmJyb3dzZXJpZnkub3V0LCBhcmdEaXIoKSksIGNvbG9ycy5ibHVlKVxuICAgICAgICAgICAgICAgICAgICAgICAgcnVuY21kICdicm93c2VyaWZ5JywgXCIje28uYnJvd3NlcmlmeS5tYWlufSAje28uYnJvd3NlcmlmeS5vdXR9XCIsIGNvbmZpZy5wYXRoICdicm93c2VyaWZ5Jywgc2xhc2gucmVzb2x2ZSh0YXJnZXRGaWxlKSwgb3B0XG5cbmZvciBjbWQgaW4gWyd1cGRhdGUnLCAnYnVtcCcsICdjb21taXQnLCAncHVibGlzaCcsICd0ZXN0J11cblxuICAgIGlmIGFyZ3NbY21kXVxuXG4gICAgICAgIGlmIG5vdCBydW5jbWQgY21kLCBhcmdzLmFyZ3VtZW50cy5qb2luICcgJywgcHJvY2Vzcy5jd2QoKVxuICAgICAgICAgICAgYnJlYWtcblxuICAgICAgICBjb25zb2xlLmxvZyAn8J+UpyAgZG9uZScuZ3JheSBpZiBhcmdzLnZlcmJvc2VcblxuICAgICAgICBpZiBhcmdzLmFyZ3VtZW50cyBhbmQgY21kIGluIFsnY29tbWl0JywgJ2J1bXAnXVxuICAgICAgICAgICAgYnJlYWtcblxuaWYgYXJncy53YXRjaFxuICAgIHdhdGNoIHdsaywgb3B0XG4gICAgIl19
//# sourceURL=../coffee/konrad.coffee