(function() {
  /*
   0000000  000000000   0000000   000000000  000   000   0000000
  000          000     000   000     000     000   000  000     
  0000000      000     000000000     000     000   000  0000000 
       000     000     000   000     000     000   000       000
  0000000      000     000   000     000      0000000   0000000 
  */
  var _, argDir, args, childp, colors, doFetch, doStatus, error, gitStatus, kork, log, pretty, render, slash, valid,
    indexOf = [].indexOf;

  ({colors, childp, slash, valid, args, error, log, _} = require('kxk'));

  log = console.log;

  kork = require('kork');

  render = require('./render');

  argDir = require('./argdir');

  pretty = require('./pretty');

  gitStatus = function(sourceFile) {
    var git, gitDir;
    gitDir = slash.dir(sourceFile);
    git = require('simple-git')(gitDir);
    return doFetch(git, gitDir, sourceFile);
  };

  
  // 00000000  00000000  000000000   0000000  000   000  
  // 000       000          000     000       000   000  
  // 000000    0000000      000     000       000000000  
  // 000       000          000     000       000   000  
  // 000       00000000     000      0000000  000   000  
  doFetch = function(git, gitDir, sourceFile) {
    return git.fetch(function(err, status) {
      if (err) {
        return error(`git fetch error ${err}`);
      }
      return doStatus(git, gitDir, sourceFile);
    });
  };

  
  //  0000000  000000000   0000000   000000000  000   000   0000000  
  // 000          000     000   000     000     000   000  000       
  // 0000000      000     000000000     000     000   000  0000000   
  //      000     000     000   000     000     000   000       000  
  // 0000000      000     000   000     000      0000000   0000000   
  doStatus = function(git, gitDir, sourceFile) {
    return git.status(function(err, status) {
      var a, aheadBehind, arglist, c, change, changes, d, diff, f, fileLists, filtered, gitFile, gitPath, i, j, k, l, lame, len, len1, len2, len3, ls, m, n, o, prfx, ref, ref1, ref2, ref3, ref4, relPath, res, results, rgs, v;
      if (err) {
        return error(`git status error ${err}`);
      }
      changes = [];
      fileLists = _.omitBy(status, function(v, k) {
        return _.isEmpty(v);
      });
      for (k in fileLists) {
        v = fileLists[k];
        m = {
          not_added: colors.gray,
          conflicted: colors.yellow,
          modified: colors.green,
          created: colors.magenta,
          deleted: colors.red
        };
        if (indexOf.call(_.keys(m), k) >= 0) {
          ref1 = (ref = status[k]) != null ? ref : [];
          for (i = 0, len = ref1.length; i < len; i++) {
            f = ref1[i];
            d = argDir();
            arglist = _.filter(args.arguments, function(a) {
              return a !== 'fetch';
            });
            if (arglist.length) {
              filtered = true;
              for (j = 0, len1 = arglist.length; j < len1; j++) {
                a = arglist[j];
                if (slash.join(gitDir, f).indexOf(slash.resolve(a)) === 0) {
                  filtered = false;
                  break;
                }
              }
              if (filtered) {
                if (args.debug) {
                  log('filtered', slash.resolve(a), f, slash.join(gitDir, f));
                }
                continue;
              }
            }
            prfx = "    ";
            prfx = m[k]("█   ");
            gitFile = slash.join(gitDir, f);
            relPath = slash.relative(gitFile, '.');
            lame = slash.extname(gitFile) === '.js' || slash.basename(gitFile) === 'package.json';
            change = prfx + pretty.filePath(relPath, lame && m[k].dim || m[k]);
            
            // 0000000    000  00000000  00000000  
            // 000   000  000  000       000       
            // 000   000  000  000000    000000    
            // 000   000  000  000       000       
            // 0000000    000  000       000       
            if ((k === 'modified' || k === 'created') && args.diff) {
              if (lame) {
                continue;
              }
              res = childp.execSync(`git diff -U0 --ignore-space-at-eol ${gitFile}`, {
                encoding: 'utf8',
                cwd: gitDir
              });
              diff = "";
              c = '▼'.bold.blue;
              ref2 = res.split(/\r?\n/);
              for (n = 0, len2 = ref2.length; n < len2; n++) {
                l = ref2[n];
                ls = colors.strip(l);
                if (((ref3 = ls[0]) === '+' || ref3 === '-' || ref3 === '@') && ((ref4 = ls.substr(0, 4)) !== '+++ ' && ref4 !== '--- ')) {
                  if (ls[0] === '+') {
                    rgs = kork.ranges(ls.substr(1), slash.ext(f));
                    if (valid(rgs)) {
                      diff += "\n " + render(rgs);
                    } else {
                      diff += "\n " + (ls.substr(1)).white;
                    }
                  } else if (ls[0] === '-') {
                    diff += "\n " + (ls.substr(1)).gray.bold.dim;
                  } else {
                    diff += "\n" + c;
                    c = '●'.blue.dim;
                  }
                }
              }
              if (diff.length) {
                change += diff + "\n" + "▲".blue.dim;
              }
            }
            changes.push(change);
          }
        }
      }
      relPath = slash.relative(gitDir, '.');
      if (relPath === '') {
        relPath = '.';
      }
      gitPath = pretty.filePath(relPath, colors.white);
      aheadBehind = function() {
        var st;
        if (status.ahead || status.behind) {
          st = '';
          if (status.ahead) {
            st += `▲ ${status.ahead}`.gray.bold.bgBlack;
          }
          if (status.behind) {
            st += `▼ ${status.behind}`.red.bold.bgBlack;
          }
          return st = _.padEnd(st, 4);
        } else {
          return '';
        }
      };
      log(('    ' + gitPath + ' ').bgBlue + ' ' + aheadBehind());
      results = [];
      for (o = 0, len3 = changes.length; o < len3; o++) {
        c = changes[o];
        results.push(log(c));
      }
      return results;
    });
  };

  module.exports = {
    gitStatus: gitStatus
  };

}).call(this);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdHVzLmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIi4uL2NvZmZlZS9zdGF0dXMuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQUE7Ozs7Ozs7QUFBQSxNQUFBLENBQUEsRUFBQSxNQUFBLEVBQUEsSUFBQSxFQUFBLE1BQUEsRUFBQSxNQUFBLEVBQUEsT0FBQSxFQUFBLFFBQUEsRUFBQSxLQUFBLEVBQUEsU0FBQSxFQUFBLElBQUEsRUFBQSxHQUFBLEVBQUEsTUFBQSxFQUFBLE1BQUEsRUFBQSxLQUFBLEVBQUEsS0FBQTtJQUFBOztFQVFBLENBQUEsQ0FBRSxNQUFGLEVBQVUsTUFBVixFQUFrQixLQUFsQixFQUF5QixLQUF6QixFQUFnQyxJQUFoQyxFQUFzQyxLQUF0QyxFQUE2QyxHQUE3QyxFQUFrRCxDQUFsRCxDQUFBLEdBQXdELE9BQUEsQ0FBUSxLQUFSLENBQXhEOztFQUVBLEdBQUEsR0FBUyxPQUFPLENBQUM7O0VBQ2pCLElBQUEsR0FBUyxPQUFBLENBQVEsTUFBUjs7RUFDVCxNQUFBLEdBQVMsT0FBQSxDQUFRLFVBQVI7O0VBQ1QsTUFBQSxHQUFTLE9BQUEsQ0FBUSxVQUFSOztFQUNULE1BQUEsR0FBUyxPQUFBLENBQVEsVUFBUjs7RUFFVCxTQUFBLEdBQVksUUFBQSxDQUFDLFVBQUQsQ0FBQTtBQUVSLFFBQUEsR0FBQSxFQUFBO0lBQUEsTUFBQSxHQUFTLEtBQUssQ0FBQyxHQUFOLENBQVUsVUFBVjtJQUNULEdBQUEsR0FBTSxPQUFBLENBQVEsWUFBUixDQUFBLENBQXNCLE1BQXRCO1dBQ04sT0FBQSxDQUFRLEdBQVIsRUFBYSxNQUFiLEVBQXFCLFVBQXJCO0VBSlEsRUFoQlo7Ozs7Ozs7O0VBNEJBLE9BQUEsR0FBVSxRQUFBLENBQUMsR0FBRCxFQUFNLE1BQU4sRUFBYyxVQUFkLENBQUE7V0FFTixHQUFHLENBQUMsS0FBSixDQUFVLFFBQUEsQ0FBQyxHQUFELEVBQUssTUFBTCxDQUFBO01BRU4sSUFBRyxHQUFI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QUFDLElBQUksQ0FBQyxJQUFJLENBQUMsUUFEeEM7O1VBRUEsSUFBRyxNQUFNLENBQUMsTUFBVjtZQUNJLEVBQUEsSUFBTSxDQUFBLEVBQUEsQ0FBQSxDQUFLLE1BQU0sQ0FBQyxNQUFaLENBQUEsQ0FBb0IsQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBRHhDOztpQkFFQSxFQUFBLEdBQUssQ0FBQyxDQUFDLE1BQUYsQ0FBUyxFQUFULEVBQWEsQ0FBYixFQU5UO1NBQUEsTUFBQTtpQkFRSSxHQVJKOztNQURVO01BV2QsR0FBQSxDQUFJLENBQUMsTUFBQSxHQUFTLE9BQVQsR0FBbUIsR0FBcEIsQ0FBd0IsQ0FBQyxNQUF6QixHQUFrQyxHQUFsQyxHQUF3QyxXQUFBLENBQUEsQ0FBNUM7QUFDQTtNQUFBLEtBQUEsMkNBQUE7O3FCQUNJLEdBQUEsQ0FBSSxDQUFKO01BREosQ0FBQTs7SUF6Rk8sQ0FBWDtFQUZPOztFQThGWCxNQUFNLENBQUMsT0FBUCxHQUNJO0lBQUEsU0FBQSxFQUFVO0VBQVY7QUF4SUoiLCJzb3VyY2VzQ29udGVudCI6WyIjIyNcbiAwMDAwMDAwICAwMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMDAwICAwMDAgICAwMDAgICAwMDAwMDAwXG4wMDAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAgIFxuMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwMDAwMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCBcbiAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgICAgICAgMDAwXG4wMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAwMDAwIFxuIyMjXG5cbnsgY29sb3JzLCBjaGlsZHAsIHNsYXNoLCB2YWxpZCwgYXJncywgZXJyb3IsIGxvZywgXyB9ID0gcmVxdWlyZSAna3hrJ1xuXG5sb2cgICAgPSBjb25zb2xlLmxvZ1xua29yayAgID0gcmVxdWlyZSAna29yaydcbnJlbmRlciA9IHJlcXVpcmUgJy4vcmVuZGVyJ1xuYXJnRGlyID0gcmVxdWlyZSAnLi9hcmdkaXInXG5wcmV0dHkgPSByZXF1aXJlICcuL3ByZXR0eSdcblxuZ2l0U3RhdHVzID0gKHNvdXJjZUZpbGUpIC0+XG5cbiAgICBnaXREaXIgPSBzbGFzaC5kaXIgc291cmNlRmlsZVxuICAgIGdpdCA9IHJlcXVpcmUoJ3NpbXBsZS1naXQnKSBnaXREaXJcbiAgICBkb0ZldGNoIGdpdCwgZ2l0RGlyLCBzb3VyY2VGaWxlXG4gICAgXG4jIDAwMDAwMDAwICAwMDAwMDAwMCAgMDAwMDAwMDAwICAgMDAwMDAwMCAgMDAwICAgMDAwICBcbiMgMDAwICAgICAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIFxuIyAwMDAwMDAgICAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwICAgICAgIDAwMDAwMDAwMCAgXG4jIDAwMCAgICAgICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAgICAgMDAwICAgMDAwICBcbiMgMDAwICAgICAgIDAwMDAwMDAwICAgICAwMDAgICAgICAwMDAwMDAwICAwMDAgICAwMDAgIFxuXG5kb0ZldGNoID0gKGdpdCwgZ2l0RGlyLCBzb3VyY2VGaWxlKSAtPlxuICAgIFxuICAgIGdpdC5mZXRjaCAoZXJyLHN0YXR1cykgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIGVyciB0aGVuIHJldHVybiBlcnJvciBcImdpdCBmZXRjaCBlcnJvciAje2Vycn1cIlxuICAgICAgICBkb1N0YXR1cyBnaXQsIGdpdERpciwgc291cmNlRmlsZVxuICAgICAgICBcbiMgIDAwMDAwMDAgIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgIFxuIyAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAgICAgXG4jIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMDAwMDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICBcbiMgICAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMCAgICAgICAwMDAgIFxuIyAwMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAwMDAgICAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAgXG5cbmRvU3RhdHVzID0gKGdpdCwgZ2l0RGlyLCBzb3VyY2VGaWxlKSAtPlxuICAgICAgICBcbiAgICBnaXQuc3RhdHVzIChlcnIsc3RhdHVzKSAtPlxuXG4gICAgICAgIGlmIGVyciB0aGVuIHJldHVybiBlcnJvciBcImdpdCBzdGF0dXMgZXJyb3IgI3tlcnJ9XCJcblxuICAgICAgICBjaGFuZ2VzID0gW11cblxuICAgICAgICBmaWxlTGlzdHMgPSBfLm9taXRCeSBzdGF0dXMsICh2LGspIC0+IF8uaXNFbXB0eSB2XG5cbiAgICAgICAgZm9yIGssdiBvZiBmaWxlTGlzdHNcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbSA9XG4gICAgICAgICAgICAgICAgbm90X2FkZGVkOiAgY29sb3JzLmdyYXlcbiAgICAgICAgICAgICAgICBjb25mbGljdGVkOiBjb2xvcnMueWVsbG93XG4gICAgICAgICAgICAgICAgbW9kaWZpZWQ6ICAgY29sb3JzLmdyZWVuXG4gICAgICAgICAgICAgICAgY3JlYXRlZDogICAgY29sb3JzLm1hZ2VudGFcbiAgICAgICAgICAgICAgICBkZWxldGVkOiAgICBjb2xvcnMucmVkXG5cbiAgICAgICAgICAgIGlmIGsgaW4gXy5rZXlzIG1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBmb3IgZiBpbiBzdGF0dXNba10gPyBbXVxuICAgICAgICAgICAgICAgICAgICBkID0gYXJnRGlyKClcblxuICAgICAgICAgICAgICAgICAgICBhcmdsaXN0ID0gXy5maWx0ZXIgYXJncy5hcmd1bWVudHMsIChhKSAtPiBhIG5vdCBpbiBbJ2ZldGNoJ11cbiAgICAgICAgICAgICAgICAgICAgaWYgYXJnbGlzdC5sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkID0gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGEgaW4gYXJnbGlzdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIHNsYXNoLmpvaW4oZ2l0RGlyLCBmKS5pbmRleE9mKHNsYXNoLnJlc29sdmUgYSkgPT0gMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJlZCA9IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiBmaWx0ZXJlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZyAnZmlsdGVyZWQnLCBzbGFzaC5yZXNvbHZlKGEpLCBmLCBzbGFzaC5qb2luKGdpdERpciwgZikgaWYgYXJncy5kZWJ1Z1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlXG5cbiAgICAgICAgICAgICAgICAgICAgcHJmeCAgICA9IFwiICAgIFwiXG4gICAgICAgICAgICAgICAgICAgIHByZnggICAgPSBtW2tdIFwi4paIICAgXCJcbiAgICAgICAgICAgICAgICAgICAgZ2l0RmlsZSA9IHNsYXNoLmpvaW4gZ2l0RGlyLCBmXG4gICAgICAgICAgICAgICAgICAgIHJlbFBhdGggPSBzbGFzaC5yZWxhdGl2ZSBnaXRGaWxlLCAnLidcbiAgICAgICAgICAgICAgICAgICAgbGFtZSAgICA9IHNsYXNoLmV4dG5hbWUoZ2l0RmlsZSkgPT0gJy5qcycgb3Igc2xhc2guYmFzZW5hbWUoZ2l0RmlsZSkgPT0gJ3BhY2thZ2UuanNvbidcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlICA9IHByZnggKyBwcmV0dHkuZmlsZVBhdGgocmVsUGF0aCwgKGxhbWUgYW5kIG1ba10uZGltIG9yIG1ba10pKVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgIyAwMDAwMDAwICAgIDAwMCAgMDAwMDAwMDAgIDAwMDAwMDAwICBcbiAgICAgICAgICAgICAgICAgICAgIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgIyAwMDAgICAwMDAgIDAwMCAgMDAwMDAwICAgIDAwMDAwMCAgICBcbiAgICAgICAgICAgICAgICAgICAgIyAwMDAgICAwMDAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgIyAwMDAwMDAwICAgIDAwMCAgMDAwICAgICAgIDAwMCAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmIGsgaW4gWydtb2RpZmllZCcsICdjcmVhdGVkJ10gYW5kIGFyZ3MuZGlmZlxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZSBpZiBsYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcyA9IGNoaWxkcC5leGVjU3luYyBcImdpdCBkaWZmIC1VMCAtLWlnbm9yZS1zcGFjZS1hdC1lb2wgI3tnaXRGaWxlfVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuY29kaW5nOiAndXRmOCdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjd2Q6IGdpdERpclxuICAgICAgICAgICAgICAgICAgICAgICAgZGlmZiA9IFwiXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAn4pa8Jy5ib2xkLmJsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBsIGluIHJlcy5zcGxpdCAvXFxyP1xcbi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBscyA9IGNvbG9ycy5zdHJpcChsKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsc1swXSBpbiBbJysnLCAnLScsICdAJ10pIGFuZCAobHMuc3Vic3RyKDAsNCkgbm90IGluIFsnKysrICcsICctLS0gJ10pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxzWzBdID09ICcrJ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmdzID0ga29yay5yYW5nZXMgbHMuc3Vic3RyKDEpLCBzbGFzaC5leHQgZlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgdmFsaWQgcmdzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlmZiArPSBcIlxcbiBcIiArIHJlbmRlciByZ3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaWZmICs9IFwiXFxuIFwiICsgKGxzLnN1YnN0cigxKSkud2hpdGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiBsc1swXSA9PSAnLSdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmYgKz0gXCJcXG4gXCIgKyAobHMuc3Vic3RyKDEpKS5ncmF5LmJvbGQuZGltXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpZmYgKz0gKFwiXFxuXCIrYylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAn4pePJy5ibHVlLmRpbVxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlICs9IGRpZmYrXCJcXG5cIitcIuKWslwiLmJsdWUuZGltIGlmIGRpZmYubGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlcy5wdXNoIGNoYW5nZVxuXG4gICAgICAgIHJlbFBhdGggPSBzbGFzaC5yZWxhdGl2ZSBnaXREaXIsICcuJ1xuICAgICAgICByZWxQYXRoID0gJy4nIGlmIHJlbFBhdGggPT0gJydcbiAgICAgICAgZ2l0UGF0aCA9IHByZXR0eS5maWxlUGF0aCByZWxQYXRoLCBjb2xvcnMud2hpdGVcblxuICAgICAgICBhaGVhZEJlaGluZCA9ICgpIC0+XG4gICAgICAgICAgICBpZiBzdGF0dXMuYWhlYWQgb3Igc3RhdHVzLmJlaGluZFxuICAgICAgICAgICAgICAgIHN0ID0gJydcbiAgICAgICAgICAgICAgICBpZiBzdGF0dXMuYWhlYWRcbiAgICAgICAgICAgICAgICAgICAgc3QgKz0gXCLilrIgI3tzdGF0dXMuYWhlYWR9XCIuZ3JheS5ib2xkLmJnQmxhY2tcbiAgICAgICAgICAgICAgICBpZiBzdGF0dXMuYmVoaW5kXG4gICAgICAgICAgICAgICAgICAgIHN0ICs9IFwi4pa8ICN7c3RhdHVzLmJlaGluZH1cIi5yZWQuYm9sZC5iZ0JsYWNrXG4gICAgICAgICAgICAgICAgc3QgPSBfLnBhZEVuZCBzdCwgNFxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICcnXG5cbiAgICAgICAgbG9nICgnICAgICcgKyBnaXRQYXRoICsgJyAnKS5iZ0JsdWUgKyAnICcgKyBhaGVhZEJlaGluZCgpXG4gICAgICAgIGZvciBjIGluIGNoYW5nZXNcbiAgICAgICAgICAgIGxvZyBjXG5cbm1vZHVsZS5leHBvcnRzID0gXG4gICAgZ2l0U3RhdHVzOmdpdFN0YXR1c1xuIl19
//# sourceURL=../coffee/status.coffee