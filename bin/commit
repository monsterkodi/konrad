#!/usr/bin/env bash

# if [ "`sds -rp 'konrad.bump on'`" = "commit" ]; then
#     `dirname $0`/bump
# fi

if [ $# -eq 0 ]; then
    if [ -e package.json ]; then
        MSG="v`sds -rp version`"
    elif [ -e ../package.json ]; then
        MSG="v`sds -rp version`"
    fi
    if [ -z "$MSG" ]; then
        echo '[ERROR] no commit message and no package.json!' | colorcat -p "(\[)(.+)(\])(.*) . Rfr . Rfy . Rfr . fy" 
        exit 1
    fi
else
    MSG="$*"
fi

git add .
git status -sb
git commit -m "$MSG" | colorcat -P `dirname $0`/../colorcat/commit.noon

echo 'pushing' | colorcat -x

git push -q
git status -sb
