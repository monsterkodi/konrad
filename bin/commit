#!/usr/bin/env bash

if [ $# -eq 0 ]; then
    if [ -e package.json ]; then
        MSG="v`sds -rp version`"
    elif [ -e ../package.json ]; then
        MSG="v`sds -rp version`"
    fi
    if [ -z "$MSG" ]; then
        echo '[ERROR] no commit message and no package.json!' | colorcat -p "(\[)(.+)(\])(.*) . Rfr . Rfy . Rfr . fy" 
        exit 1
    fi
else
    MSG="$*"
fi

git add .
git status -sb       | colorcat -P  `dirname $0`/../cc/status.noon
git commit -m "$MSG" | colorcat -sP `dirname $0`/../cc/commit.noon

echo 'pushing'       | colorcat -x

git push -q 2>&1     | colorcat -P `dirname $0`/../cc/push.noon
git status -sb       | colorcat -P `dirname $0`/../cc/status.noon
